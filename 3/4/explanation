The given implementation of itoa fails on a two's complement system because the magnitude of the largest possible negative number is larger than that of the largest positive number, and the implementation first creates a positive number and later turns it into a negative number, which fails for the largest negative number. To fix this, the program should first assume that the number is negative and then swap the sign later if necessary.
